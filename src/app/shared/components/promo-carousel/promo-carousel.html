<div class="relative w-full py-6 md:py-8" style="height: 220px;" class="max-[425px]:!h-[200px] min-[425px]:!h-[220px]">
  @if (slides.length === 0) {
    <!-- Empty state -->
    <div class="flex items-center justify-center h-full text-gray-400 text-sm">
      No promo slides available
    </div>
  } @else {
    <!-- Viewport -->
    <div class="relative overflow-hidden pl-4 pr-4">
      <!-- Track -->
      <div
        #track
        class="flex gap-4 scroll-smooth snap-x snap-mandatory overflow-x-auto scrollbar-hide"
        [style.scroll-padding-left.px]="peekPx"
        (pointerdown)="onPointerDown($event)"
        (pointermove)="onPointerMove($event)"
        (pointerup)="onPointerUp($event)"
        (pointercancel)="onPointerCancel()"
        (scroll)="onScroll()"
        (mouseenter)="onMouseEnter()"
        (mouseleave)="onMouseLeave()"
      >
        @for (slide of slides; track slide.id) {
          <div
            class="flex-[0_0_auto] snap-center w-[calc(100%-2*var(--peek))] md:w-[78%] cursor-pointer select-none"
            [style.--peek]="peekPx + 'px'"
            (click)="onSlideClick($index)"
          >
            <!-- Card -->
            <div
              class="relative rounded-xl md:rounded-2xl overflow-hidden transition-transform duration-300 hover:scale-[1.02] shadow-2xl h-[180px] min-md:h-[200px]"
            >
              <!-- Background gradient -->
              <div class="absolute inset-0" [class]="getGradientClasses(slide.theme)"></div>

              <!-- Glow effect (right side) -->
              <div class="absolute right-0 top-0 bottom-0 w-32 md:w-48 opacity-20 md:opacity-30 blur-2xl md:blur-3xl" [class]="getGlowClasses(slide.theme)"></div>

              <!-- Decorative lines -->
              <div class="hidden md:block absolute bottom-4 left-8 w-32 h-1 bg-white/5 rounded-full transform -rotate-12"></div>
              <div class="hidden md:block absolute bottom-8 left-12 w-24 h-1 bg-white/5 rounded-full transform rotate-6"></div>

              <!-- Content -->
              <div class="relative h-full flex items-center justify-between px-4 md:px-6 lg:px-8">
                <!-- Left content -->
                <div class="flex-1 space-y-1 md:space-y-2 z-10">
                  <!-- Badge -->
                  <div class="inline-block">
                    <span class="px-2 py-0.5 md:px-3 md:py-1 rounded-full text-[10px] md:text-xs font-semibold" [class]="getBadgeClasses(slide.theme)">
                      {{ slide.badge }}
                    </span>
                  </div>

                  <!-- Title -->
                  <h3 class="text-white font-bold text-base md:text-xl lg:text-2xl leading-tight">
                    {{ slide.title }}
                  </h3>

                  <!-- Subtitle -->
                  <p class="text-white/70 text-xs md:text-sm lg:text-base max-w-[200px] md:max-w-xs leading-snug md:leading-relaxed">
                    {{ slide.subtitle }}
                  </p>

                  <!-- CTA Button -->
                  <button
                    class="mt-1 md:mt-2 px-3 py-1.5 md:px-5 md:py-2 rounded-lg md:rounded-xl font-semibold text-xs md:text-sm transition-all duration-200 hover:scale-105 active:scale-95"
                    [class]="getCtaClasses(slide.theme)"
                  >
                    {{ slide.cta }}
                  </button>
                </div>

                <!-- Right icon -->
                <div class="hidden md:flex items-center justify-center w-20 h-20 lg:w-24 lg:h-24 z-10">
                  @switch (slide.icon) {
                    @case ('crown') {
                      <svg class="w-20 h-20 text-yellow-400/40" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 2L15.5 8.5L22 9.27L17 14.14L18.18 20.77L12 17.5L5.82 20.77L7 14.14L2 9.27L8.5 8.5L12 2Z"/>
                        <path d="M12 6L14 10L18 10.5L15 13.5L15.8 17.5L12 15.5L8.2 17.5L9 13.5L6 10.5L10 10L12 6Z" fill="currentColor" opacity="0.6"/>
                      </svg>
                    }
                    @case ('btc') {
                      <svg class="w-20 h-20 text-orange-400/40" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M16.2 10.5c.3-.9.1-1.8-.5-2.4-.9-.9-2.3-1-3.7-.9V4.5h-1.5v2.6c-.4 0-.8 0-1.2.1V4.5H7.8v2.7c-.3 0-.7 0-1 .1H4.5v1.6s1.1 0 1.1.1c.6 0 .8.4.8.7v6.8c0 .3-.1.7-.6.7 0 0-1.1 0-1.1 0l-.3 1.8h2.2c.4 0 .8 0 1.2.1v2.7h1.5v-2.6c.4 0 .8 0 1.2-.1v2.6h1.5v-2.7c1.9-.1 3.3-.6 3.9-1.9.5-1 .2-2.3-.7-2.9.7-.4 1.2-1.1 1.3-2zm-3.8 5c-.3 1.2-2.4 1-3.6.9V13c1.2.1 3.4.3 3.6 2.5zm-.5-5c-.3 1.1-2 .9-3 .8V9c1 .1 2.8.2 3 2.5z"/>
                      </svg>
                    }
                    @case ('gift') {
                      <svg class="w-20 h-20 text-pink-400/40" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"/>
                      </svg>
                    }
                    @default {
                      <div class="w-20 h-20 rounded-full bg-white/10 flex items-center justify-center">
                        <span class="text-white/50 text-3xl">âœ¨</span>
                      </div>
                    }
                  }
                </div>
              </div>
            </div>
          </div>
        }
      </div>
    </div>

    <!-- Pagination dots -->
    @if (slides.length > 1) {
      <div class="flex items-center justify-center gap-2 mt-6">
        @for (slide of slides; track slide.id; let i = $index) {
          <button
            class="transition-all duration-300 rounded-full"
            [class.w-8]="i === currentIndex()"
            [class.w-2]="i !== currentIndex()"
            [class.h-2]="true"
            [class.bg-purple-500]="i === currentIndex()"
            [class.bg-white/30]="i !== currentIndex()"
            (click)="goToSlide(i)"
            [attr.aria-label]="'Go to slide ' + (i + 1)"
            [attr.aria-current]="i === currentIndex() ? 'true' : 'false'"
          ></button>
        }
      </div>
    }
  }
</div>
